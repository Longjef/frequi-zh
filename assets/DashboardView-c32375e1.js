import{a as x,D as I}from"./DraggableContainer-023fd31c.js";import{C as F,P as H,T as M}from"./TradesLog-ef86944f.js";import{d as E,u as G,h as i,o as y,f as D,w as o,a as _,i as n,j as T,t as O,c as R,C as q,g as N,a3 as J,y as K,E as Q,r as W,F as k,aT as S,s as X,G as $,b as a,H as L}from"./index-25b30797.js";import{P,b as U}from"./InfoBox.vue_vue_type_script_setup_true_lang-ba02b64a.js";import{T as j}from"./TradeList-039c2364.js";import"./install-d3bc5c4a.js";import"./chartZoom-aca2eae4.js";const Y={class:"d-flex flex-row"},Z={key:0},ee=["title"],te={class:"text-small"},ae={key:0},oe={class:"text-profit"},le={class:"text-loss"},se=E({__name:"BotComparisonList",setup(z){const t=G(),v=[{key:"botName",label:"机器人"},{key:"trades",label:"交易数"},{key:"profitOpen",label:"持仓盈利"},{key:"profitClosed",label:"平仓盈利"},{key:"balance",label:"资产"},{key:"winVsLoss",label:"赢/亏"}],V=i(()=>{const B=[],d={botId:void 0,botName:"合",profitClosed:0,profitClosedRatio:void 0,profitOpen:0,profitOpenRatio:void 0,stakeCurrency:"USD",wins:0,losses:0};return Object.entries(t.allProfit).forEach(([s,l])=>{var c,m,f,p,h;const e=t.allOpenTrades[s].reduce((g,r)=>g+r.stake_amount,0),u=t.allOpenTrades[s].reduce((g,r)=>g+r.profit_ratio*r.stake_amount,0)/e,b=t.allOpenTrades[s].reduce((g,r)=>g+(r.profit_abs??0),0);B.push({botId:s,botName:t.availableBots[s].botName,trades:`${t.allOpenTradeCount[s]} / ${((c=t.allBotState[s])==null?void 0:c.max_open_trades)||"N/A"}`,profitClosed:l.profit_closed_coin,profitClosedRatio:l.profit_closed_ratio||0,stakeCurrency:((m=t.allBotState[s])==null?void 0:m.stake_currency)||"",profitOpenRatio:u,profitOpen:b,wins:l.winning_trades,losses:l.losing_trades,balance:((f=t.allBalance[s])==null?void 0:f.total_bot)??((p=t.allBalance[s])==null?void 0:p.total),stakeCurrencyDecimals:((h=t.allBotState[s])==null?void 0:h.stake_currency_decimals)||3}),l.profit_closed_coin!==void 0&&(d.profitClosed+=l.profit_closed_coin,d.profitOpen+=l.profit_all_coin,d.wins+=l.winning_trades,d.losses+=l.losing_trades)}),B.push(d),B});return(B,d)=>{const s=J,l=K;return y(),D(l,{ref:"tradesTable",small:"",hover:"","show-empty":"","primary-key":"botId",items:V.value,fields:v},{"cell(botName)":o(e=>[_("div",Y,[e.item.botId&&n(t).botCount>1?(y(),D(s,{key:0,modelValue:n(t).botStores[e.item.botId].isSelected,"onUpdate:modelValue":u=>n(t).botStores[e.item.botId].isSelected=u,title:"Show bot in Dashboard"},null,8,["modelValue","onUpdate:modelValue"])):T("",!0),_("span",null,O(e.value),1)])]),"cell(profitOpen)":o(e=>[e.item.profitOpen&&e.item.botId!="Summary"?(y(),D(P,{key:0,"profit-ratio":e.item.profitOpenRatio,"profit-abs":e.item.profitOpen,"stake-currency":e.item.stakeCurrency},null,8,["profit-ratio","profit-abs","stake-currency"])):T("",!0)]),"cell(profitClosed)":o(e=>[e.item.profitClosed&&e.item.botId!="Summary"?(y(),D(P,{key:0,"profit-ratio":e.item.profitClosedRatio,"profit-abs":e.item.profitClosed,"stake-currency":e.item.stakeCurrency},null,8,["profit-ratio","profit-abs","stake-currency"])):T("",!0)]),"cell(balance)":o(e=>[e.item.balance?(y(),R("div",Z,[_("span",{title:e.item.stakeCurrency},O(n(q)(e.item.balance,e.item.stakeCurrencyDecimals)),9,ee),_("span",te,O(e.item.stakeCurrency),1)])):T("",!0)]),"cell(winVsLoss)":o(e=>[e.item.losses!==void 0?(y(),R("div",ae,[_("span",oe,O(e.item.wins),1),N(" / "),_("span",le,O(e.item.losses),1)])):T("",!0)]),_:1},8,["items"])}}}),re={class:"d-flex justify-content-center"},ie={class:"d-flex justify-content-center"},ye=E({__name:"DashboardView",setup(z){const t=G(),v=Q(),V=W(""),B=r=>{V.value=r},d=i(()=>["","sm","md","lg","xl"].includes(V.value)),s=i(()=>v.layoutLocked||!d.value),l=i(()=>d.value?v.dashboardLayout:[...v.getDashboardLayoutSm]),e=r=>{d.value&&(console.log("newlayout",r),console.log("saving dashboard"),v.dashboardLayout=r)},u=i(()=>k(l.value,S.dailyChart)),b=i(()=>k(l.value,S.botComparison)),c=i(()=>k(l.value,S.allOpenTrades)),m=i(()=>k(l.value,S.allClosedTrades)),f=i(()=>k(l.value,S.cumChartChart)),p=i(()=>k(l.value,S.profitDistributionChart)),h=i(()=>k(l.value,S.tradesLogChart)),g=i(()=>({sm:v.getDashboardLayoutSm}));return X(async()=>{await t.allGetDaily({timescale:30}),t.activeBot.getOpenTrades(),t.activeBot.getProfit()}),(r,ne)=>{const C=$("grid-item"),A=$("grid-layout");return y(),D(A,{class:"h-100 w-100","row-height":50,layout:l.value,"vertical-compact":!1,margin:[5,5],"responsive-layouts":g.value,"is-resizable":!s.value,"is-draggable":!s.value,responsive:!0,"prevent-collision":!0,cols:{lg:12,md:12,sm:12,xs:4,xxs:2},"col-num":12,onLayoutUpdated:e,onBreakpointChanged:B},{default:o(({gridItemProps:w})=>[a(C,L(w,{i:u.value.i,x:u.value.x,y:u.value.y,w:u.value.w,h:u.value.h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:o(()=>[a(x,{header:`日收益 ${n(t).botCount>1?"合计":""}`},{default:o(()=>[n(t).allDailyStatsSelectedBots?(y(),D(I,{key:0,"daily-stats":n(t).allDailyStatsSelectedBots,"show-title":!1},null,8,["daily-stats"])):T("",!0)]),_:1},8,["header"])]),_:2},1040,["i","x","y","w","h"]),a(C,L(w,{i:b.value.i,x:b.value.x,y:b.value.y,w:b.value.w,h:b.value.h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:o(()=>[a(x,{header:"机器人对比"},{default:o(()=>[a(se)]),_:1})]),_:2},1040,["i","x","y","w","h"]),a(C,L(w,{i:c.value.i,x:c.value.x,y:c.value.y,w:c.value.w,h:c.value.h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:o(()=>[a(x,null,{header:o(()=>[_("div",re,[N(" 当前委托 "),a(U,{class:"ms-2",hint:"Open trades of all selected bots. Click on a trade to go to the trade page for that trade/bot."})])]),default:o(()=>[a(j,{"active-trades":"",trades:n(t).allOpenTradesSelectedBots,"multi-bot-view":""},null,8,["trades"])]),_:1})]),_:2},1040,["i","x","y","w","h"]),a(C,L(w,{i:f.value.i,x:f.value.x,y:f.value.y,w:f.value.w,h:f.value.h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:o(()=>[a(x,{header:"累计收益"},{default:o(()=>[a(F,{trades:n(t).allTradesSelectedBots,"show-title":!1},null,8,["trades"])]),_:1})]),_:2},1040,["i","x","y","w","h"]),a(C,L(w,{i:m.value.i,x:m.value.x,y:m.value.y,w:m.value.w,h:m.value.h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:o(()=>[a(x,null,{header:o(()=>[_("div",ie,[N(" 成交记录 "),a(U,{class:"ms-2",hint:"Closed trades for all selected bots. Click on a trade to go to the trade page for that trade/bot."})])]),default:o(()=>[a(j,{"active-trades":!1,"show-filter":"",trades:n(t).allClosedTradesSelectedBots,"multi-bot-view":""},null,8,["trades"])]),_:1})]),_:2},1040,["i","x","y","w","h"]),a(C,L(w,{i:p.value.i,x:p.value.x,y:p.value.y,w:p.value.w,h:p.value.h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:o(()=>[a(x,{header:"收益分布"},{default:o(()=>[a(H,{trades:n(t).allTradesSelectedBots,"show-title":!1},null,8,["trades"])]),_:1})]),_:2},1040,["i","x","y","w","h"]),a(C,L(w,{i:h.value.i,x:h.value.x,y:h.value.y,w:h.value.w,h:h.value.h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:o(()=>[a(x,{header:"日志"},{default:o(()=>[a(M,{trades:n(t).allTradesSelectedBots,"show-title":!1},null,8,["trades"])]),_:1})]),_:2},1040,["i","x","y","w","h"])]),_:1},8,["layout","responsive-layouts","is-resizable","is-draggable"])}}});export{ye as default};
//# sourceMappingURL=DashboardView-c32375e1.js.map
